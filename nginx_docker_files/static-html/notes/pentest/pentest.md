# Pentesting notes

## Note taking

To take and edit (add notes, mark with red square, censor, etc) screenshot we recomend to install flameshot and assig a shortcut (like ctrl + shift + f) to the command `flameshot gui` on the configuration of your GUI/desktop environment  

## Escaneo de red

```bash
$nmap -sS -Pn -sV -A -p- 192.168.1.0/24
```

```bash
$nmap --script nmap-vulners -sV 192.168.1.0/24
```

```bash
$nmap --script vuln -sV 192.168.1.0/24
```


```bash
$nmap --script vuln -sV -p- -O -oA archivoSalida 192.168.1.0/24
```


```javascript
var s = "JavaScript syntax highlighting";
alert(s);
```
## Automatizar scripts
Usando bash 
```bash
#!/bin/bash
for ip in $(cat ip.txt); do
nmap -sTV -p 22 -vvv  -O --script=vuln  $ip -oA vuln$ip  -T4
done
```
## Quikly mount an http server
Use the command
```console
$ python3 -m http.server 80
```

## Port listener with netcat

Use netcat to setup a net listener:
```console
$ nc -lvnp 443
-l listen mode
-v verbose
-n numeric-only IP 
-p port 
```
## Gobuster

List directories of a web server. Use:
```console
gobuster dir -u 10.10.10.28  -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt
```
That wordlist in the example is one of the wordlists that comes with the `dirbuster` command instalation.

## SSLscan
You can audit a certificate with the SSLscan program, eg.
```console
sslscan rodgpe.com
```
## Subdomain enumeration

The program used to enumerate subdomain is sublist3r, here is an example:

```console
sublist3r -d rodgpe.com
```
The `-d` flag is used to indicate that the program is going to take a domain as a parameter.
Then you can use the output with the command `host` to derive the IP addresses asosiated to each domain.

```console
host rodgpe.com
```
## Andriod APK pentest

TODO write the steps requiered to download an APK to a host OS like kali

Thera are some programms used to decompile apk like `dex2jar` or `jd-gui`, if we want to edit the app it's better to use `apktool`
```console
apktool d app.apk
```
That creats a human readble folder with files
To decompile `.dex` we use `dex2jar` like this
```console
apt install dex2jar
d2j-dex2jar classes.dex 
```
Now we have a .jar file that we con open with any editor it's recomended to use `jd-gui`
```console
apt install jd-gui
```
# Useful commands
## How to use cron and crontab
run de command `crontab -e` to edit the cron table. The [crontab guru](https://crontab.guru/#*/1_*_*_*_*) site can be used to validate crontab entries.
For example, this crontab entry will run every 5 minuts and it will take a screenshot and save to the Pictures folder
```
*/5 * * * *  flameshot full -p /home/rodrigo/Pictures
```
or you can make a shell script and run it with cron, like this
```
*/5 * * * *  /home/rodrigo/screen.sh
```
the content of screen.sh should look like this
```console
mkdir -p $HOME/.logger/$(date +'%Y%m%d')/screenshots
DISPLAY=:0 flameshot full -p /home/rodrigo/Pictures
```
The `$(date +'%Y%m%d')` part of the script is used to get the string of the date from de OS, it can also give us the time with `$(date +'%H%M')`

## Redirect output to file
The easiest way to save the terminal output to file is with the `>` operator to redirect to a new file, e.g.:
```console
command > file.txt
```

If we don't want to creat a new file we can append the output with `>>`, e.g.;
```console
command >> existingfile.txt
```
But some times the output can't be redirected with those operators, in those cases we need to take the output from the `stderr` with the `&>` and `&>>`operators. This is the case of the `wget`command.
```console
$ wget gentera.com.mx   &>  chale.txt 
```

## Setup an ultriwide monitor in linux (kali)
Sometimes when we tried to use an ultrawide monitor in kali linux, it only uses a fraction of the available display and it blanks in the rest. This may be caused by the `xrandr` can't make the automatic adjustment, in order to do it manually we need a way to generate a modeline that `xrandr` uses to format the output, for this we can use the command 
```console
$ cvt 3440 1440 50 
```
Where 3440 and 1440 is your horizontal and vertical screen resolution respectively, and 50 is the refresh rate of the monitor.
Even then, `cvt` can return a non-compatible modeline. To solve this issue we can try plugin the monitor to ubuntu, wich is more likely to create a compatible  modeline and copy it to kali. To list the modeline in ubuntu we can use the next command 
```console
$ xvidtune -show
```
Now that we have a modeline, it's necesary to creat it in `xrandr` with the following command:
```console
xrandr --newmode "ubuntuModeline" 265.25  3440 3488 3520 3600  1440 1443 1453 1474 +hsync -vsync
```
Then assign it to an output with
```console
xrandr --addmode HDMI-1 ubuntuModeline
```
where `HDMI-1` is the display output we want to modify and `ubuntuModeline` is the name of the modeline previously created

Lastly, in order to apply the changes type this command:
```console
xrandr --output HDMI-1 --mode ubuntuModeline
```

# Crypto and Network Security

RFC 2828 / 4949 for Internet Security Glossary it containes terms like
- Security service

Some services 
- Confidentiality
- Integrity - has
- Accountability - digital signature
- Autentication - Messega autentication code (MAC)

There has to be a Trueste third parties like:
- Google truste services
- GoDaddy
- Verisign
- DigiCert
- Thawte

## PKI 
Is a framework to generate, manage, distribute, sotre and revoke digital certificates

## Classic cipher 
- transposition
- substitution
    - monoalphabetic
    - polyalphabetic
        - vegenere 

## Block cipher: chaining mode
- Electronic codebook (ECD), without feedback
- Cipbher block chaining (CBC), with feedback, it needs an inicialization vector for chaining
- Cipher Feedback, after XOR
- Output Feedback, befor XOR

For key sharing its used Asymetric encryption or Diffie-Hellman

## Asymetric
Is 10,000 times slower than symetric ciphers

## Diffie-Hellman
generata a shared secrete.

## Trust
- Web of trust
- Certificates

## MAC
the sender takes de message, calculates it's hash, then ecrypt the hash value with a shared secret key and append it to the massage 

## Letter frequency analysis

## Confusion and Diffusion
Confusion hides any relationship between the plaintext, ciphertext and the key
Defussion spread the effect of plaintext or key bits over as much of the ciphertext as possible

## IpSec is a framework
- ESP protocol Ensapsulation secirity payload
- AH  autenticaton header
- Key managment
It uses Securitiy parameter index SPI and Security Assosiations SA

IPSec it uses two modes
- Transport mode - ecrypts the data portion, but not the headers
- Tunnel mode  - encrypts bothe, the data and the headers
# Computer history and curius sites

TODO make a site for computer history 
computerhistory.org
cybermap.kaspersky.com
cryptocouple.com
